<!DOCTYPE html>
<html>
<head>
    <title>Project Naptha</title>

    <meta charset="utf8">
    <link href='../design.css' rel='stylesheet'>
    <link href='https://fonts.googleapis.com/css?family=Lato:300,400,700' rel='stylesheet' type='text/css'>
</head>
<body>
    <div style="overflow: auto" class="header">
        <h1 style="margin-bottom: 0; float: left">Project <span style="color: rgb(255, 133, 0)">Naptha</span> </h1>
        <h3 style="color: gray; float: right;  font-weight: normal; margin-top: 1.7em">account status</h3>
    </div>
    <div id="project_naptha_inject_status">
        <div style="overflow:auto">
            <div class="jumbo red">    

                <div class="internal" style="padding-bottom: 40px">
                    <p>
                        "I'm sorry Dave, I'm afraid I can't let you do that"


                    </p>    
                </div>
            </div>
            <div class="content">
                It looks like there's something wrong with your installation of Project Naptha. Double check that the extension is properly installed and that it hasn't been disabled. 
            </div>
        </div>
    </div>

    <div id="project_naptha_loading_status" style="display: none">
        <div style="overflow:auto">
            <div class="jumbo blue">    

                <div class="internal" style="padding-bottom: 40px">
                    <p>
                        Loading...
                    </p>    
                </div>
            </div>
            <div class="content">
                We're currently fetching the current account status from the server. This shouldn't take more than a few seconds. 
            </div>
        </div>
    </div>


    <div  class="header" style="margin-bottom: 40px">
        Go back to the  <a href="/">home page </a>
    </div>

    <script>
        document.addEventListener('NapthaDataEvent', function(e){
            function get(attr){ return e.target.getAttribute(attr) }
            
            console.log("naptha installation version", get('version'))


            var injection = document.getElementById("project_naptha_inject_status");
            injection.style.display = 'none';

            var injection_load = document.getElementById("project_naptha_loading_status")
            injection_load.style.display = '';


            var xhr = new XMLHttpRequest();
            xhr.open('GET', get('apiroot') + 'webstatus?user=' + encodeURIComponent(get('user_id')), true)
            xhr.onload = function(){
                injection_load.style.display = 'none';
                injection.innerHTML = xhr.responseText;
                injection.style.display = '';
            }
            xhr.send(null)

        }, false)
    </script>

    <script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-50196519-1', 'projectnaptha.com');
        ga('send', 'pageview');

    </script>
</body>
</html>